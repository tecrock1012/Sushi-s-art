<!DOCTYPE html>
<html style="font-size: 16px;" lang="en"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <title>Products</title>
    <link rel="stylesheet" href="nicepage.css" media="screen">
    <link rel="stylesheet" href="products.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 7.4.4, nicepage.com">
    <link rel="stylesheet" href="style.css" media="screen">
    
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
    <link id="u-page-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lobster:400">
    <script type="application/ld+json">{
	"@context": "http://schema.org",
	"@type": "Organization",
	"name": ""
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Products">
    <meta property="og:type" content="website">
  <meta data-intl-tel-input-cdn-path="intlTelInput/"></head>
  <body data-path-to-root="./" data-include-products="false" class="u-body u-xl-mode" data-lang="en">
  <header class="u-clearfix u-header u-header" id="header">
    <div class="u-clearfix u-sheet u-sheet-1">
      <nav class="u-menu u-menu-one-level u-offcanvas u-menu-1">
        <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
          <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-hamburger-link u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
            <svg class="u-svg-link" viewBox="0 0 24 24"><use xlink:href="#menu-hamburger"></use></svg>
            <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg">
              <g><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect></g>
            </svg>
          </a>
        </div>
        <div class="u-custom-menu u-nav-container">
          <ul class="u-nav u-unstyled u-nav-1">
            <li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="./" style="padding: 10px 20px;">Home</a></li>
            <li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="products.html" style="padding: 10px 20px;">Store</a></li>
            <li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="grow-garden.html" style="padding: 10px 20px;">Grow a Garden</a></li>
            <li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="About--Us.html" style="padding: 10px 20px;">About  Us</a></li>
          </ul>
        </div>
        <div class="u-custom-menu u-nav-container-collapse">
          <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
            <div class="u-inner-container-layout u-sidenav-overflow">
              <div class="u-menu-close"></div>
              <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2">
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="./">Home</a></li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="products.html">Store</a></li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="grow-garden.html">Grow a Garden</a></li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="About--Us.html">About  Us</a></li>
              </ul>
            </div>
          </div>
          <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
        </div>
      </nav>
      <p class="u-custom-font u-font-lobster u-text u-text-1">SUSHI'S ART </p>
      <a href="cart.html" class="cart-btn">ðŸ›’ View Cart</a>
    </div>
  </header>

  <style>
    .container { padding: 20px; }
    .detail { display: flex; flex-wrap: wrap; gap: 30px; }
    .image img { max-width: 300px; border-radius: 12px; }
    .content { max-width: 500px; }
    .content h1, .content h4, .content .price, .content h5, .content h6 {
      margin: 8px 0;
    }
    .option, .buttons { margin-top: 15px; }
    .option select { padding: 5px; }
  </style>
</head>
<body>

  <div class="container">
    <div class="title">PRODUCT DETAIL</div>
    <div class="detail">
      <div class="image">
        <img id="productImage" src="" alt="Product Image" onerror="this.src='https://via.placeholder.com/300x300?text=No+Image'" />
      </div>
      <div class="content">
        <h1 class="name">Loading...</h1>
        <div class="price"></div>
        <h4 class="code"></h4>

        <div class="option">
          <label for="typeSelect">Choose Type:</label>
          <select id="typeSelect">
            <option value="None">None</option>
            <option value="Magnet">Magnet</option>
            <option value="Keychain">Keychain</option>
          </select>
        </div>

        <div class="buttons">
          <button onclick="checkout()">Check Out</button>
          <button onclick="addToCart()">Add To Cart</button>
        </div>

        <h5 class="madeby"></h5>
        <h6 class="shape"></h6>
        <h6 class="Width"></h6>
        <h6 class="height"></h6>
        <h6 class="side"></h6>
        <h6 class="side1"></h6>
        <h6 class="side2"></h6>
        <h6 class="Diameter"></h6>
      </div>
    </div>
  </div>

<script>
const apiUrl = 'https://script.google.com/macros/s/AKfycbyisIvU_DAG1B5SFgNxjZ6_7d19v4xwA86u4nySdiTDRuTHlehEbXDBf_xqOnku20KJ4w/exec';
const id = new URLSearchParams(window.location.search).get("Id");
let product = null;
let cart = JSON.parse(localStorage.getItem("cart") || "[]");

function getDriveThumbnailURL(linkOrId, width = 600) {
  const match = linkOrId?.match(/[-\w]{25,}/);
  const fileId = match ? match[0] : null;
  return fileId ? `https://drive.google.com/thumbnail?id=${fileId}&sz=w${width}` : "";
}

fetch(apiUrl)
  .then(res => res.json())
  .then(data => {
    console.log("ðŸ”Ž URL Id:", id);
    product = data.find(p => (p.Id || "").toString().trim() === (id || "").toString().trim());

    if (!product) {
      alert("This product is not available.");
      location.href = "products.html";
      return;
    }

    if ((product["Sold"] || "").toLowerCase() === "yes") {
      alert("This product is already sold.");
      location.href = "products.html";
      return;
    }

    showProduct(product);
  })
  .catch(err => {
    console.error("âŒ Error fetching product data:", err);
    alert("Failed to load product info. Please try again later.");
  });

function showProduct(p) {
  document.querySelector(".name").innerText = p.Item || "Unnamed";
  document.querySelector(".price").innerText = "â‚¹" + (p.Price || "N/A");
  document.querySelector(".code").innerText = p.Code || "";
  document.getElementById("productImage").src = getDriveThumbnailURL(p.Picture || "");

  showIf(".madeby", p["Made by"], "Made by - ");
  showIf(".shape", p.Shape, "Shape: ");
  showIf(".Width", p.Width, "Width: ");
  showIf(".height", p.Height, "Height: ");
  showIf(".side", p.Side, "Side: ");
  showIf(".side1", p["Side 1"], "Side 1: ");
  showIf(".side2", p["Side 2"], "Side 2: ");
  showIf(".Diameter", p.Diameter, "Diameter: ");
}

function showIf(selector, value, prefix = "") {
  const el = document.querySelector(selector);
  if (value) {
    el.innerText = prefix + value;
    el.style.display = "block";
  } else {
    el.style.display = "none";
  }
}

function addToCart() {
  const selectedOption = document.getElementById("typeSelect").value;
  const existing = cart.find(c => c.id === product.Id && c.option === selectedOption);
  if (existing) {
    alert("Already in cart");
    return;
  }
  cart.push({
    id: product.Id,
    name: product.Item,
    price: product.Price,
    image: getDriveThumbnailURL(product.Picture, 200),
    option: selectedOption
  });
  localStorage.setItem("cart", JSON.stringify(cart));
  alert("Added to cart!");
}

function checkout() {
  const selectedOption = document.getElementById("typeSelect").value;
  let msg = `Hi, I'm interested in:\n${product.Code} - â‚¹${product.Price}`;
  if (selectedOption && selectedOption !== "None") {
    msg += `\nOption: ${selectedOption}`;
  }
  window.open(`https://wa.me/+918208952199?text=${encodeURIComponent(msg)}`);
}
</script>
</body>
</html>
